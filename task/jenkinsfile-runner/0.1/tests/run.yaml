apiVersion: tekton.dev/v1beta1
kind: PipelineRun
metadata:
  name: jenkinsfile-runner-run
spec:
  podTemplate:
    securityContext:
      runAsUser: 0 # because the jenkinsfile-runner image cannot run without using uid 0, we are forcing this. :-( FIXME
  pipelineSpec:
    results:
      - name: build_number
        description: The run build number
        value: $(tasks.start.results.build_number)
    workspaces:
      - name: source
      - name: jenkins
    tasks:
      - name: start
        taskRef:
          name: jenkinsfile-runner
        workspaces:
          - name: source
            workspace: source
        params:
          - name: JENKINSFILE_URL
            value: https://raw.githubusercontent.com/akram/jenkinsfile-runner-openshift/f2f/Jenkinsfile
        workspaces:
          - name: source
            workspace: source
  workspaces:
  - name: source
    emptyDir: {}
  - name: jenkins
    emptyDir: {}
